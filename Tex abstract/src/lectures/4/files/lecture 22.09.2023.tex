	\subsection{Разложение идеалов в произведение простых в кольцах целых числовых полей}

	\begin{lemma}\label{prime_ideals_product_lemma}
		Пусть $A$~--- нётерово, $I \subset A$~--- ненулевой идеал. Тогда существуют такие простые идеалы $\fp_{1}, \ldots, \fp_{k}$, что $\fp_{1} \fp_{2} \ldots \fp_{k} \subset I$.
	
	\end{lemma}

	\begin{proof}
		Предположим противное, то есть, что существуют идеаы, для которых не выполнено условие леммы. Выберем среди таких максимальный (мы можем так сделать в силу нётеровости кольца), назовём его $I$. Заметим, что $I$~--- не простой идеал, что означает, что $\exists x, y\colon \notin I\colon xy \in I$. Кроме того, $I$~--- собственный идеал. Значит, 
		\[
			I + (x) \supset (x), \quad I + (y) \supset I,
		\]
		причем включение строгое. Тогда для идеалов $I + (x)$ и $I + (y)$ условие леммы уже выполняется, то есть $\exists \fp_{1}, \ldots, \fp_{k}$ и $\fq_{1}, \ldots, \fq_{m}$ такие, что $\fp_{1}\ldots \fp_{k} \subset I + (x)$, $\fq_{1} \ldots \fq_{m} \subset I + (y)$.
		Но тогда мы имеем 
		\[
			\fp_{1}\ldots\fp_{k}\fq_{1}\ldots\fq_{m} \subset (I + (x))(I + (y)) \subset I, \text{ так как } xy \in I,
		\]
		что даёт нам противоречие. 
	\end{proof}


	\begin{definition} 
		Пусть $K/\Q$~--- конечное расширение, $0 \neq I \subset \cO_{K}$~--- идеал. Тогда введём 
		\[
			I^{-1} \eqdef \{ x \in K \ \vert \ xI \subset \cO_{K} \}.
		\]
	\end{definition}

	\noindent\bf{Свойства:}

	\begin{enumerate}
		\item $x, y \in I^{-1} \implies x + y \in I^{-1}$.
		
		\item Если $x \in I^{-1}$, а $a \in \cO_{K}$, то $ax \in I^{-1}$.
	\end{enumerate}
	\begin{proof}
			Действительно, $(x + y)I \subset xI + yI \subset \cO_{K}$. Если $xI \subset \cO_{K}$, то для $a \in \cO_{K}$
			мы получим $axI = xaI = xI$, так как $I$~--- идеал в $\cO_{K}$.
		\end{proof}

	\begin{remark}
		Заметим, что $I^{-1}$~--- $\cO_{K}$-модуль. Кроме того, если $a \in I$, то $aI^{-1}$~--- идеал в $\cO_{K}$.
		В частности, $aI^{-1}$ конечнопорожден,  а значит, $aI^{-1}$~--- конечнопорожденный $\cO_{K}$-модуль. 
	\end{remark}

	\begin{example}
		Пусть $K = \Q,$ тогда $\cO_{K} = \Z$ и любой идеал $I \subset \Z$ имеет вид $I = (a)$. Тогда $(a)^{-1} = a^{-1}\Z$.
	\end{example}

	\begin{lemma}\label{frac_ideal_is_not_ring}
		Пусть $I \subset \cO_{K}$~--- ненулевой собственный идеал. тогда $I^{-1} \neq \O_{K}$.
	\end{lemma}

	\begin{proof}
		Докажем, что существуует $x \in K$ такой, что $x \notin \cO_{K}$ и при этом $xI \in \cO_{K}$.
		Выберем в $I$ ненулевой элемент $a$. Рассмотрим $(a) \subset I$, по лемме~\ref{prime_ideals_product_lemma} найдутся такие ненулевые 
		$\fp_{1}, \ldots, \fp_{k} \in \Spec{\cO_{K}}$, что $\fp_{1}\ldots\fp_{k} \subset (a)$. 

		Так как $I$~--- собственный, а кольцо $\cO_{K}$ одномерно, $I$ лежит в некотором простом идеале $\fp$. Так мы получаем цепочку включений 
		\[
			\fp_{1}\ldots \fp_{k} \subset (a) \subset \fp \implies \ \exists i\colon \fp_{i} \subset \fp.
 		\]
 		Так как оба идеала максимальны, это не включение, а равенство. Не умаляя общности, пусть $\fp_{1} = \fp$. Теперь, пусть $k = 1$. 
 		Тогда мы имеем $\fp \subset (a) \subset  I \subset \fp \implies I = \fp = (a) \implies I^{-1} = a^{-1}\cO_{K}$. 
 		Значит, $x = a^{-1} \notin \cO_{K}$, так как иначе $I = \cO_{K}$. 

 		Теперь пусть $k \ge 2$, выберем $k$ минимально возможным.  Тогда 
 		\[
 			\fp_{2}  \ldots \fp_{k} \not\subset (a) \implies \exists b \in \fp_{2}\ldots \fp_{k} \setminus (a).
 		\]
 		Тогда мы можем взять $x = \frac{b}{a}$ и тогда $xI = \frac{b}{a}I \subset \frac{b}{a}\fp_{1} \subset \frac{\fp_{1}\ldots \fp_{k}}{a} \subset \frac{(a)}{a} = \cO_{K}$. Остаётся проверить, что $\frac{b}{a} \notin \cO_{K}$.В самом деле, если $\frac{b}{a} \in \cO_{K}$, то $b \in (a)$, что противоречит выбору $b$.
	\end{proof}

	\begin{remark}
		Ясно, что включение $\cO_{K} \subset I^{-1}$ верно всегда, так как просто по определению идеала $\forall x \in \cO_{K} \ xI \subset \cO_{K}$
	\end{remark}

	Возьмём $\fp \in \Spec{\cO_{K}}$ и рассмотрим $\fp \fp^{-1}$. С одной стороны, это идеал в $\cO_{K}$, причём он содержит $\fp$.

	\begin{lemma}\label{p p^{-1} = (1)} 
		Пусть $\fp \in \Spec{\O_{K}}$, тогда $\fp \fp^{-1} = (1) = \cO_{K}$.
	\end{lemma}
	\begin{proof}
		Предположим противное, тогда в силу максимальности идеала $\fp$ мы имеем $\fp \fp^{-1} = \fp$. 
		Пусть $\fp = (u_{1}, \ldots, u_{n})$, тогда если $\alpha \in \fp^{-1} \setminus \cO_{K}$ (тут мы пользуемся леммой~\ref{frac_ideal_is_not_ring}), то $\alpha u_{1} \in \fp$ и мы можем написать систему уравнений 
		\[
			\begin{cases} \alpha u_{1} = \sum\limits_{u = 1}^{n} a_{1 i} u_{i}   \\
			\alpha u_{2} = \sum\limits_{u = 1}^{n} a_{2 i} u_{i} \\ 
			\vdots \\ 
			\alpha u_{n} = \sum\limits_{i = 1}^{n} a_{n i} u_{i} \end{cases}
		\]
		В матричной форме эта система будет иметь вид 
		\[
			\underbrace{\begin{pmatrix} \alpha - a_{11} & \ldots & \ldots & \ldots \\ \ldots & \alpha - a_{22} & \ldots & \ldots \\ \vdots & \vdots & \ddots & \vdots \\ \ldots & \ldots & \ldots & \alpha - a_{nn} \end{pmatrix}}_{= B} \cdot \begin{pmatrix} u_{1} \\ u_{2} \\ \vdots \\ u_{n} \end{pmatrix} = 0.
		\]
		Значит, $\det{B} = 0$, что даёт нам унитарный многочлен с коэффициентами из $\cO_{K}$, обнуляющий $\alpha$. Тогда, так как $\cO_{K}$~--- целозамкнуто, $\alpha \in \cO_{K}$, противоречие. 
	\end{proof}

	Теперь мы достаточно подготовились, чтоб доказать, что в кольце $\cO_{K}$ любой идеал раскладывается в произведение простых единственным образом. 

	\begin{theorem}[О разложении идеалов в произведение простых]\label{ideal_factorization}
		Пусть $0 \neq I \subset \cO_{K}$~--- идеал. Тогда $I$ однозначно (с точностью до перестановки сомножителей) раскладывается в произведение простых идеалов. 
	\end{theorem}

	\begin{proof} Как обычно, проходит в два этапа. \\
		\emph{Существование:} Предположим, что существуют идеалы, не раскладывающиеся в произведение простых. Среди таких идеалов возьмём максимальный, обозанчим его $I$ (мы можем так сделать, потому что $\cO_{K}$~--- нётерово кольцо). Он содержистся в некотором максимальном идеале $\fp \in \Specm{\cO_{K}}$. Тогда $I \fp^{-1} \subset \fp \fp^{-1} = \cO_{K}$~--- идеал. Значит, нам остаётся показать, что $I \fp^{-1} \neq I$. Покажем, что $I I^{-1} = \cO_{K}$, тогда мы сможем просто домножить и всё получистя. 

		\begin{lemma} 
			Для любого идеала $I \subset \cO_{K}$ мы имеем $I I^{-1} = \cO_{K}$. 
		\end{lemma}

		\begin{proof}
			Пусть это не так, тогда $I I^{-1} \subset \fq$, где $\fq$~--- максимальный идеал. Тогда $I I^{-1} \fq^{-1} \subset \fq \fq^{-1} = \cO_{K} \implies  I^{-1}\fq^{-1} \subset I^{-1}$. Так как $\fq^{-1}$ не совпадает с $\cO_{K}$, мы можем выбрать $\alpha \in \fq^{-1}\setminus \cO_{K}$. Проделывая рассуждение, аналогичное лемме~\ref{p p^{-1} = (1)} мы получаем, что $\alpha \in \cO_{K}$, что даёт нам противоречие. 
		\end{proof}

		Итак, если $I \fp^{-1} = I$, то $\fp^{-1} = \cO_{K}$, что противоречит лемме~\ref{frac_ideal_is_not_ring}. Значит, $I \subset I\fp^{-1} $, следовательно мы можем разложить $I \fp^{-1}$ в произведение простых:
		\[
			I \fp^{-1} = \fp_{1} \fp_{2} \ldots \fp_{k} \implies I = \fp_{1} \fp_{2} \ldots \fp_{k} \cdot \fp, 
		\]
		что и требовалось. \\
		\emph{Единственность:} Пусть $\fp \fp_{1} \ldots \fp_{m} = \fp \fq_{1} \ldots \fq_{n}$, тогда $\fp_{1} \fp_{2} \ldots \fp_{m} \subset \fq_{1} \implies \ \exists i\colon \fp_{i} \subset \fq_{i}$, а так как они максимальны, $\fp_{i} = \fq_{1}$, что даёт нам противоречие. 
	\end{proof}

	\begin{definition} 
		Пусть $I \subset K$. $I$ называется \emph{дробным идеалом}, если $\exists x \neq 0\colon x I \subset \cO_{K}$~--- идеал.
	\end{definition}

	\begin{example}
		$I^{-1}$~--- дробный идеал. 
	\end{example}

	\begin{statement} 
		Ненулевые дробные идеалы образуют группу по умножению. 
	\end{statement}

	\begin{proof}
		Легко заметить, что произведение дробных идеалов~--- дробный идеал. Обратный определяется как и раньше:
		\[
			I^{-1} \eqdef \{ x \in K \ \vert \ xI \subset \cO_{K} \}.
		\]
		Нетрудно убедиться в том, что $I I^{-1} = \cO_{K}$. 
	\end{proof}

	Из теоремы~\ref{ideal_factorization} следует, что любой дробный идеал раскладывается в произведение простых идеалов (возможно, с отрицательными степенями). Действительно, пусть $J$~--- дробный идеал, тогда для некоторого $x \in K \ xJ = I$~--- идеал в $\cO_{K}$, тогда 
	\[
		J = (x)^{-1}I = \fp_{1}^{-1} \ldots \fp_{k}^{-1} \fq_{1}\ldots \fq_{m}.
	\]

	Значит, группа дробных идеалов~--- свободная абелева группа, образующие которой~--- элементы $\Spec{\cO_{K}}$.

	\begin{example}
		Для кольца $\Z$ дробные идеалы соотвествуют рациональным числам. 
	\end{example}

	\begin{homework}
		Задачи: 
		\begin{enumerate}
			\item Докажите, что кольцо $\cO_{K}$ факториально тогда и только тогда, когда $\cO_{K}$~--- кольцо главных идеалов. 

			\item  Разложите число $33 + 11\sqrt{-7}$ на неприводимые в кольце $\cO_{K}$, где $K = \Q(\sqrt{-7})$.

			\item Пусть $\fp \in \Specm{\cO_{K}}$. Введём на группе дробных идеалов \emph{нормирование} следующим образом: $\upsilon_{\fp}\lr*{I} =$ степень, с которой $\fp$ входит в разложение дробного идеала $I$. Иными словами, 
			\[
				I = \fp^{\upsilon_{\fp(I)}} \cdot \fq_{1} \cdot  \fq_{2} \cdot \ldots \cdot \fq_{m}.
			\]
			Для $a \in K^{*}$ определим $\upsilon_{\fp}(a) \eqdef \upsilon_{\fp}((a))$. Так вот, докажите, что:
			\begin{itemize}
				\item $\upsilon_{\fp}(I + J) = \min\lr*{\upsilon_{p}(I), \upsilon_{\fp}(J)}$.
				\item $\upsilon_{\fp}(I \cap J) = \max\lr*{\upsilon_{p}(I),\upsilon_{\fp}(J)}$.
				\item $\upsilon_{\fp}(a + b) \ge \min\lr*{\upsilon_{\fp}(a), \upsilon_{\fp}(b)}$ и равенство достигается в случае $\upsilon_{\fp}(a) \neq \upsilon_{\fp}(b)$.
				\item $\upsilon_{\fp}(IJ) = \upsilon_{\fp}(I) + \upsilon_{\fp}(J)$.
				\item $\upsilon_{\fp}(ab) = \upsilon_{\fp}(a) + \upsilon_{\fp}(b)$.

			\end{itemize}
			Таким образом, $\upsilon_{\fp}$~--- гомоморфизм $K^{*} \to \Z$. Этот гомоморфизм называют \emph{дисретным нормированием, соотвествующим идеалу $\fp$}.

		\end{enumerate}
	\end{homework}


	



	